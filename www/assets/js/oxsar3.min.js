window.__gameStripImages__={init:function(c,b,D,q,k){void 0===c&&(c=".strip");void 0===b&&(b=2);void 0===D&&(D=0);void 0===q&&(q=300);if(void 0===k){k=[];for(var e=0;e<b;e++)k.push(e)}$(c).each(function(){var a=$(this);if(!a.data("strip_initialized")){a.css({display:"block",position:"relative",overflow:"hidden"});var c=a.find("img").css({position:"absolute",left:0,top:0}),r=new Image,e=function(){if(r.onload){r.onload=void 0;var f=r.width/b;a.css({width:f+"px",height:r.height+"px"});a.data("strip_initialized",
!0);c.css("left",Math.round(f*-k[0])+"px");setTimeout(function(){var a=0;setInterval(function(){a=(a+1)%k.length;var b=Math.round(f*-k[a]);0<D?c.animate({left:b},D):c.css("left",b+"px")},q)},q*Math.random())}else console.log("[StripImages] duplicate onload for",r.src)};r.onload=e;setTimeout(function(){r.src=c.attr("src");setTimeout(function(){r.onload&&0<r.width&&e()},1)},1);a.data("strip_initialized",!0)}})}};"use strict";
(function(c){window.oxsar3={main:function(b){c("#"+(void 0===b.mapId?"map-canvas":b.mapId)).galaxymap({B:1,size:{c:[-900,900],d:[-900,900],a:64,j:10},s:45,q:40,v:1,g:0,m:"/assets/img/rule-horiz.png",u:"/assets/img/rule-vert.png",backgroundImage:"/assets/img/galaxy-bg/2.jpg",C:""})}};c.widget("game.galaxymap",{options:{C:"",B:1,size:{c:[1,19],d:[1,19],j:10,a:30},s:30,q:30,v:1,m:"",u:"",backgroundImage:"",w:"black",g:0.5,A:"galaxy-map-corner",l:"galaxy-map-horiz-rule",t:"galaxy-map-vert-rule",k:"galaxy-map-content",
r:"galaxy-map-rule-number",f:"center",i:void 0},_create:function(){function b(a,b){a&&(b["background-image"]="url('"+a+"')");return b}function D(a,b){var c;void 0===c&&(c=1);a+=123*c;b+=123*c;return"rgb("+((300*a+50*b)%256|0)+","+((70*a+20*b)%256|0)+","+((100*a+150*b)%256|0)+")"}function q(){var a=new Date;return(a.getTime()+a.getMilliseconds()/1E3)/1E3}function k(){x=void 0;for(var a=0;2>a;a++)3E3<Math.abs(l[a])&&(l[a]=3E3*(0>l[a]?-1:1));E=setInterval(function(){for(var a=0;2>a;a++)l[a]*=0.85,20>
Math.abs(l[a])&&(l[a]=0);if(l[0]||l[1]){var a=q(),b=Math.max(0.01,a-y);y=a;e.moveToOffs(w[0]+l[0]*b,w[1]+l[1]*b)}else clearInterval(E)},50)}console.log("galaxyMap._create",this);var e=this,a=this.options,d=c('<table><tr><td class="'+a.A+'"></td><td class="'+a.l+'"></td></tr><tr><td class="'+a.t+'"></td><td class="'+a.k+' bg-full-size"></td></tr></table>').css({"border-collapse":"collapse","border-spacing":0,padding:0,margin:0,width:"100%",height:"100%"}).appendTo(this.element);d.find("td").css({padding:0,
margin:0});var r=d.find("."+a.l).css(b(a.m,{"background-repeat":"repeat-x","background-position":"left bottom",position:"relative",overflow:"hidden",height:a.q+"px"})),A=d.find("."+a.t).css(b(a.u,{"background-repeat":"repeat-y","background-position":"right top",position:"relative",overflow:"hidden",width:a.s+"px"})),f=d.find("."+a.k).css({position:"relative",overflow:"hidden"}),n=null;a.backgroundImage&&f.append(n=c('<div class="bg-full-size"></div>').css({opacity:a.D||0.2,"background-image":"url('"+
a.backgroundImage+"')","background-position":"50% 50%","background-repeat":"no-repeat",position:"absolute",left:0,top:0,width:"100%",height:"100%"}).hide().fadeIn(3E3));0<a.g&&f.append(c("<div />").css({"background-color":a.w,opacity:a.g,position:"absolute",left:0,top:0,width:"100%",height:"100%"}));var F=c("<div />").css({position:"absolute"}).appendTo(f),B={},G=0,w=[0,0];this.getOffs=function(){return[w[0],w[1]]};this.moveToOffs=function(b,s){function k(a){a.h?a.visible||console.log("break loading chunk ",
a.x,a.y,"it is not visible"):console.log("break loading chunk ",a.x,a.y,"it has already removed")}var u=f.width(),t=f.height(),m,p,g=a.v;b=b<u+(a.size.c[1]+g)*-a.size.a+1?u+(a.size.c[1]+g)*-a.size.a+1:b>-(a.size.c[0]-g)*a.size.a?-(a.size.c[0]-g)*a.size.a:b;s=s<t+(a.size.d[1]+g)*-a.size.a+1?t+(a.size.d[1]+g)*-a.size.a+1:s>-(a.size.d[0]-g)*a.size.a?-(a.size.d[0]-g)*a.size.a:s;w=[b,s];r.css({"background-position":b+"px bottom"}).empty();m=b%a.size.a-a.size.a;for(p=(m-b)/a.size.a|0;m<u+a.size.a;m+=a.size.a,
p++)g=c("<div />").text(p).addClass(a.r).css({position:"absolute"}).appendTo(r),g.css({left:m-g.width()/2+1,bottom:15});A.css({"background-position":"right "+s+"px"}).empty();m=s%a.size.a-a.size.a;for(p=(m-s)/a.size.a|0;m<t+a.size.a;m+=a.size.a,p++)g=c("<div />").text(p).addClass(a.r).css({position:"absolute"}).appendTo(A),g.css({top:m-g.height()/2+1,right:15});g=0;m=-(a.size.c[0]-g)*a.size.a+u/2;m=2*((b-m)/(p=-(a.size.c[1]+g)*a.size.a+u/2-m)-0.5);var e=-(a.size.d[0]-g)*a.size.a+t/2,h,g=2*((s-e)/
(h=-(a.size.d[1]+g)*a.size.a+t/2-e)-0.5);Math.abs(p)>Math.abs(h)?(e=45,p=45*h/p):(e=45*p/h,p=45);n&&n.css({"background-position":50+(-35>m*e*2?-35:35<m*e*2?35:m*e*2)+"% "+(50+(-35>g*p*2?-35:35<g*p*2?35:g*p*2))+"%"});F.css({left:b,top:s});G++;b=-b;s=-s;var d=a.size.j*a.size.a;m=b;p=s;g=b+u;e=s+t;h=b/d|0;var u=h+Math.ceil(1*u/d),l=h;h-=2;for(var u=u+(l-h+Math.max(1,2)),l=s/d|0,t=l+Math.ceil(1*t/d)+1,q=l,l=l-2,t=t+(q-l+Math.max(1,2)),v=h;v<u;v++)for(var z=l;z<t;z++){void 0===B[v]&&(B[v]={});var x=v*
d-a.size.a/2,y=z*d-a.size.a/2,q=x+d>=m&&x<g&&y+d>=p&&y<e;void 0===B[v][z]?q&&(console.log("create chuck",v,z),function(){var a=B[v][z]={x:v,y:z,tick:G,visible:!0,p:!1,h:c("<div />").css({position:"absolute",left:x,top:y,width:d,height:d}).appendTo(F).append(c("<div />").css({position:"absolute","background-color":D(v,z),opacity:0.1,width:"100%",height:"100%"})).hide().fadeIn(2E3).queue(function(){a.p=!0;k(a)})}}()):(h=B[v][z],h.tick=G,(h.visible=q)&&h.p&&void 0===h.F&&k(h))}for(var E in B){var t=
B[E],C;for(C in t)h=t[C],h.tick!=G&&(console.log("delete chuck",h.x,h.y),h.visible=!1,h.h.stop(!0).remove(),delete h.h,delete t[C])}};this.centerToXY=function(b,c){var e=f.width(),d=f.height();this.moveToOffs(-b*a.size.a+e/2,-c*a.size.a+d/2)};this.centerMap=function(){this.centerToXY((a.size.c[1]+a.size.c[0])/2,(a.size.d[1]+a.size.d[0])/2)};var x,C,l=[],y=0,E;f.bind("dragstart",function(a,b){x=[b.offsetX,b.offsetY];C=w;y=q();clearInterval(E)}).bind("dragend",function(){k()}).bind("drag",function(a,
b){if(void 0!==x){var c=b.offsetX-x[0],d=b.offsetY-x[1];if(!(1>c*c+d*d)){var f=[w[0],w[1]];e.moveToOffs(C[0]+c,C[1]+d);c=q();d=Math.max(0.01,c-y);y=c;l=[(w[0]-f[0])/d,(w[1]-f[1])/d]}}});this._destroy=function(){clearInterval(E);d.remove()};this.widget=function(){return d};void 0!==a.f?"center"==a.f?this.centerMap():this.moveToOffs(a.f[0],a.f[1]):void 0!==a.i?this.centerToXY(a.i[0],a.i[1]):this.moveToOffs(0,0)}})})(jQuery);
window.__gameTooltips__={n:!1,opacity:1,tooltip:null,b:[{x:0,y:0},{x:0,y:0}],o:null,e:null,init:function(c){var b=this;c||(c="");$(c+" .game-tooltip-content").each(function(){var b=$(this);b.data("tooltip_initialized")||(b.remove(),$("body #"+b.attr("id")).remove(),b.appendTo(document.body).hide().css({opacity:"",position:"absolute",left:-9E4,top:-9E4,"z-index":1E4}),b.data("tooltip_initialized",!0))});b.n?b.hide():(b.n=!0,$(".game-tooltip").live("mouseover",function(){var c=$(this),q;!c.hasClass("game-tooltip-disabled")&&
(q=c.attr("lang"))&&(clearTimeout(b.o),b.o=setTimeout(function(){var k=$("#game-tooltip-content-"+q);if(k.length&&(!b.tooltip||b.tooltip.attr("id")!=k.attr("id"))){b.hide();var e=$(window),a=e.scrollLeft()+5,d=e.scrollTop()+5,r=e.width()-10,e=e.height()-10,A=c.offset(),f=A.top+c.height()+5,n=A.left+5,F=!1;n+k.width()<a+r?(n<a&&(n=a),b.b[0].x=n,b.b[1].x=n+10):(n=Math.min(a+r-k.width(),A.left+c.width()-k.width()-5),n<a&&(n=a),b.b[0].x=n,b.b[1].x=n-10);f+k.height()<d+e?(f<d&&(f=d),b.b[0].y=f,b.b[1].y=
f+10,b.b[1].x=b.b[0].x):(f=A.top-k.height()-5,f<d?(f=d,F=!0,n=Math.min(a+r-k.width(),A.left-k.width()-5),n<a&&(n=a),b.b[0].x=n,b.b[1].x=n-10):b.b[1].x=b.b[0].x,b.b[0].y=f,b.b[1].y=f-(F?0:10));(b.tooltip=k).css({left:b.b[1].x,top:b.b[1].y})}b.show()},70))}),$(".game-tooltip-content").live("mouseover",function(){b.tooltip&&b.tooltip.attr("id")==$(this).attr("id")&&b.show();return!1}),$(".game-tooltip, .game-tooltip-content").live("mouseout",function(){clearTimeout(b.e);b.e=setTimeout(function(){b.hide()},
1E3);return!1}),$(".game-tooltip-content").live("click",function(){b.hide();return!1}))},hide:function(){clearTimeout(this.e);this.e=void 0;this.tooltip&&(this.tooltip.css("z-index",1E4),this.tooltip.stop(!0).animate({opacity:0,left:this.b[1].x,top:this.b[1].y},400,"easeInQuad",function(){$(this).hide().css({left:-9E4,top:-9E4})}),this.tooltip=void 0)},show:function(){clearTimeout(this.e);this.e=void 0;this.tooltip&&(this.tooltip.css("z-index",10001),this.tooltip.stop(!0).show().animate({opacity:this.opacity,
left:this.b[0].x,top:this.b[0].y},400,"easeOutCubic"))}};
